% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genoprobs-compute-similarity.R
\name{genoprobs_compute_similarity}
\alias{genoprobs_compute_similarity}
\title{Compute similarity matrix between two aligned calc_genoprob objects}
\usage{
genoprobs_compute_similarity(
  genoprobs_1,
  genoprobs_2,
  metric = c("pearson", "cosine"),
  by_chr = FALSE
)
}
\arguments{
\item{genoprobs_1, genoprobs_2}{calc_genoprob objects already aligned to the same map/grid
(e.g. via genoprobs_sync_markers).}

\item{metric}{'pearson' or 'cosine'}

\item{by_chr}{if TRUE, also return per-chromosome similarity matrices}
}
\value{
list(sim, sim_by_chr, n_features). sim has rownames = genoprobs_1 sample IDs,
  colnames = genoprobs_2 sample IDs; each cell is the similarity between that pair.
}
\description{
Compute similarity matrix between two aligned calc_genoprob objects
}
\section{What this function does (big picture)}{


Genoprobs are 3D arrays per chromosome: \code{dimnames[[1]]} = samples,
\code{dimnames[[2]]} = haplotypes (e.g. founders Aâ€“H), \code{dimnames[[3]]} =
markers. Each sample is thus a long vector of probabilities (one per
marker-haplotype combination). This function compares two such objects
(e.g. different platforms or builds) already aligned to the same grid (same
markers in the same order; e.g. via genoprobs_sync_markers). For every pair
(sample i from genoprobs_1, sample j from genoprobs_2) it computes one number: how
similar are those two probability vectors? Similarity is Pearson or cosine.
Result: matrix with rows = genoprobs_1 samples, cols = genoprobs_2 samples; cell [i,j] =
similarity of that pair. Downstream swap detection uses high similarity on
the diagonal (same mouse) and low off-diagonal.
}

\section{Sample order and sample names}{


Samples do **not** need to be in the same order in genoprobs_1 and genoprobs_2. The
function computes similarity for every (row of genoprobs_1, column of genoprobs_2) pair
and labels the output with each object's own sample names. Sample names are
**not** checked or required to match between the two objects; matching of
"which row sample is the same mouse as which column sample" is done
downstream (e.g. by genoprobs_detect_sample_swaps using a sample_map or
by inspecting the similarity matrix). Both objects must have the same
number of haplotypes and same number of markers per chromosome (enforced
internally); they may have different numbers of samples.
}

