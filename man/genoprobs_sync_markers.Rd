% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genoprobs-sync-markers.R
\name{genoprobs_sync_markers}
\alias{genoprobs_sync_markers}
\title{Synchronize genoprobs to a marker data frame}
\usage{
genoprobs_sync_markers(
  genoprobs,
  markers_df,
  marker_col = "marker",
  chr_col = "chr",
  pos_col = "pos",
  unit = c("auto", "Mb", "bp")
)
}
\arguments{
\item{genoprobs}{qtl2-style genoprobs (named list of 3D arrays by chromosome).}

\item{markers_df}{Data frame with at least marker ID, chromosome, and
position columns (see \code{marker_col}, \code{chr_col}, \code{pos_col}).}

\item{marker_col}{Name of the column in \code{markers_df} containing marker IDs.}

\item{chr_col}{Name of the chromosome column.}

\item{pos_col}{Name of the position column.}

\item{unit}{Position unit: \code{"auto"} (detect from values), \code{"Mb"}, or \code{"bp"}.}
}
\value{
A list with components:
  \item{genoprobs}{Genoprobs restricted to common chromosomes and
    markers present in both genoprobs and \code{markers_df}, in map order.}
  \item{markers}{Marker data frame with positions in bp, sorted by chr/pos;
    only markers that appear in \code{genoprobs} and \code{map} are included.}
  \item{map}{qtl2-style marker map (named list of named numeric position vectors).}
  \item{dropped_markers_not_in_gp}{Per-chromosome list of marker IDs in
    \code{markers_df} but not in genoprobs.}
  \item{dropped_markers_not_in_map}{Per-chromosome list of marker IDs in
    genoprobs but not in \code{markers_df}.}
}
\description{
Subset and reorder genoprobs so that each chromosome contains only markers
that appear in \code{markers_df}, in the order defined by the data frame
(after sorting by chromosome and position). Useful to align genoprobs with
a standard marker set (e.g. for correlation with another platform) or to
drop markers not in a given map. Positions are converted to bp if needed.
}
\details{
Only chromosomes present in both \code{genoprobs} and \code{markers_df} are
returned. Within each chromosome, only markers that appear in both are kept,
and their order follows \code{markers_df} after \code{markers_sort}. The
returned \code{genoprobs} has the same attributes and class as the input.
}
\seealso{
\code{\link{positions_to_bp}}, \code{\link{markers_sort}},
  \code{\link{genoprobs_correlate}}
}
